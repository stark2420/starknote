<!DOCTYPE html>
<html lang="ja"><script src="/starknote/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=starknote/livereload" data-no-instant defer></script><meta charset="utf-8"><meta name="generator" content="Hugo 0.140.1"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">
<link rel="icon" href="/starknote/favicon.ico" type="image/x-icon"><title>UoftCTF 2025 Writeup&nbsp;&ndash;&nbsp;しゅたるくの備忘録</title><link rel="stylesheet" href="/starknote/css/core.min.964363afdd281b37186e8f4572a119b584b5c489e7df05c552d5060e2b193d16058787359b6405833d43f4fe66a8263f.css" integrity="sha384-lkNjr90oGzcYbo9FcqEZtYS1xInn3wXFUtUGDisZPRYFh4c1m2QFgz1D9P5mqCY/"><meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="UoftCTF 2025 Writeup" /><meta name="twitter:image" content="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/cover.png" /><meta property="og:type" content="article" />
<meta property="og:title" content="UoftCTF 2025 Writeup" />
<meta property="og:site_name" content="しゅたるくの備忘録" /><meta property="og:image" content="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/cover.png" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/starknote/"><span class="site name">しゅたるくの備忘録</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/starknote/categories/">カテゴリ</a><a class="nav item" href="/starknote/tags/">タグ</a><a class="nav item" href="/starknote/about/">About</a><a class="nav item" href=""></a></nav></div></span></div></section><section id="content">
<div id="top" class="article-container"><section class="article header">
    <h1 class="article title">UoftCTF 2025 Writeup</h1><p class="article date">Jan 14, 2025</p></section><article class="article markdown-body"><p>2025/1/11 09:00(JST) - 2025/1/13 09:00(JST)で開催された UoftCTF 2025 に参加した．</p>
<p>チームで参加し，結果は，700 点で 897 チーム中 236 位だった．</p>
<p><a href="https://ctf.uoftctf.org/"target="_blank" rel="noopener noreferrer">https://ctf.uoftctf.org/</a></p>
<p>公式Writeup：
<a href="https://github.com/UofTCTF/uoftctf-2025-chals-public"target="_blank" rel="noopener noreferrer">https://github.com/UofTCTF/uoftctf-2025-chals-public</a></p>
<h2 id="crypto">Crypto</h2>
<h3 id="funny-cipher-100">funny-cipher (100)</h3>
<blockquote>
<p>A wheelbarrow ran over the flag. Can you fix it?<br>
cipher.txt</p>
</blockquote>



<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">cipher.txt</figcaption>
<div class="xCodeBlock_code"><pre tabindex="0"><code>60_ZMZ_GBWKNREM_KRA__LQM}WEPRGQL__Q_{RWW_M_KIAGPMNMRXDLM_FMWLDQ0BOIAMNPG</code></pre></div>
</figure>
<p>問題文を検索すると，以下のサイトがヒット．昨年も同じような問題が出題されたようだ．<br>
<a href="https://ctftime.org/writeup/38474"target="_blank" rel="noopener noreferrer">https://ctftime.org/writeup/38474</a></p>
<p><a href="https://www.dcode.fr/burrows-wheeler-transform"target="_blank" rel="noopener noreferrer">Burrow&rsquo;s Wheeler Transform</a> というサイトで復号できるらしい．</p>
<p>復号結果は以下のようになった．</p>
<pre tabindex="0"><code>LWPMGMP{NRN_XWL_BDWO_MZA_PRIQM_QLKQMRMLMRWD_GRFZAI_NEMAQ_KEGB_MW_600_KG}
</code></pre><p>まだflagにはなっていないが，LWPMGMP=&gt;uotfctfに置換できそう．<br>
しかしながら，規則性は見つからない．とりあえず，確定している置換を行うと以下になる．</p>
<pre tabindex="0"><code>uoftctf{???_?ou_??o?_t??_f???t_?u??t?tut?o?_c?????_??t??_??c?_to_600_?c}
</code></pre><p>真ん中の長い単語の部分を考えてみる．同じ文字は同じ文字に置換されることを踏まえると，<br>
QLKQMRMLMRWD=&gt;substitutionになりそう．</p>
<pre tabindex="0"><code>uoftctf{?i?_?ou_?no?_t??_fi?st_substitution_ci????_??t?s_b?c?_to_600_bc}
</code></pre><p>だんだん見えてきた．</p>
<pre tabindex="0"><code>uoftctf{did_you_know_the_first_substitution_ci?her_d?tes_b?ck_to_600_bc}
</code></pre><p>以下がflagである．</p>
<pre tabindex="0"><code>uoftctf{did_you_know_the_first_substitution_cipher_dates_back_to_600_bc}
</code></pre><p><code>uoftctf{did_you_know_the_first_substitution_cipher_dates_back_to_600_bc}</code></p>
<h2 id="misc">Misc</h2>
<h3 id="math-test-100">Math Test (100)</h3>
<blockquote>
<p>Complete this simple math test to get the flag.<br>
nc ~</p>
</blockquote>
<p>ncコマンドでサーバにアクセスすると，以下が表示される．計算式はランダムに変化する．</p>
<pre tabindex="0"><code>$ nc ~
Welcome to a simple math test.
If you solve these basic math questions, I will give you the flag.&#34;
Good Luck
Question: 1 + 4 // 5

Answer: 
</code></pre><p>そこで，LinuxのCLIコマンドを自動化するExpectを用いて，自動化する．
<code>-re {([^\n]+)}</code>は改行以外の任意の文字列にマッチする．
send コマンドには，<code>--</code>オプションがあり，これ以降の引数をすべて文字列として解釈する．
これがないと，負の数送るときに，<code>-</code>がフラグとして間違えられてエラーになる．</p>
<p>参考：
<a href="https://qiita.com/Mskmemory/items/013dff1a76e58fcdc364#expect%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"target="_blank" rel="noopener noreferrer">https://qiita.com/Mskmemory/items/013dff1a76e58fcdc364#expect%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</a>
<a href="https://manpages.ubuntu.com/manpages/focal/ja/man1/expect.1.html"target="_blank" rel="noopener noreferrer">https://manpages.ubuntu.com/manpages/focal/ja/man1/expect.1.html</a></p>



<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">main.sh</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/expect
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">spawn nc 34.66.235.106 <span class="m">5000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">{</span><span class="nb">set</span> i 0<span class="o">}</span> <span class="o">{</span><span class="nv">$i</span> &lt; 1000<span class="o">}</span> <span class="o">{</span>incr i<span class="o">}</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    expect <span class="s2">&#34;Question:&#34;</span>
</span></span><span class="line"><span class="cl">    expect -re <span class="o">{([</span>^<span class="se">\n</span><span class="o">]</span>+<span class="o">)}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">set</span> expression <span class="nv">$expect_out</span><span class="o">(</span>1,string<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    expect <span class="s2">&#34;Answer:&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">set</span> result <span class="o">[</span><span class="nb">exec</span> python3 -c <span class="s2">&#34;print(</span><span class="nv">$expression</span><span class="s2">)&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">    send -- <span class="s2">&#34;</span><span class="nv">$result</span><span class="s2">\r&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">send <span class="s2">&#34;exit\r&#34;</span>
</span></span><span class="line"><span class="cl">expect eof</span></span></code></pre></div></div>
</figure>
<p>実行する前に，実行権限を付与しておく．
このスクリプトを実行すると，flagが得られる．</p>
<pre tabindex="0"><code>$ chmod +x main.sh
$ ./main.sh
spawn nc ~

（省略）

Correct 1000/1000

Congratz! Here is the flag uoftctf{7h15_15_b451c_10_7357_d16u153d_45_4_m47h_7357}
</code></pre><p><code>uoftctf{7h15_15_b451c_10_7357_d16u153d_45_4_m47h_7357}</code></p>
<h2 id="web">web</h2>
<h3 id="scavenger-hunt-100">Scavenger Hunt (100)</h3>
<blockquote>
<p>You know what to do.<br>
Visit the website here</p>
</blockquote>
<p>webサイトのどこかに隠された7つのflagの断片を探す問題．以下では，開催後にローカルで実行した画像を使用する．</p>
<ol>
<li>ソースコードに，コメントとして記載．</li>
</ol>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/im01.png"
        alt="This is a image"/></p>
<ol start="2">
<li>レスポンスヘッダーに含まれている．</li>
</ol>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/im02.png"
        alt="This is a image"/></p>
<ol start="3">
<li><code>localhost:3000/robots.txt</code>にアクセス．</li>
</ol>
<pre tabindex="0"><code>User-agent: *
Disallow: /hidden_admin_panel
# part4=411_7h3_
</code></pre><ol start="4">
<li>robots.txtに書かれていた<code>localhost:3000/hidden_admin_panel</code>にアクセス．Cookieにフラグが追加される．</li>
</ol>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/im03.png"
        alt="This is a image"/></p>
<ol start="5">
<li>styles.cssに，コメントとして記載．</li>
</ol>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/im04.png"
        alt="This is a image"/></p>
<ol start="6">
<li>Cookieの<code>user:guest</code>を<code>user:admin</code>に書き換えて，<code>localhost:3000/hidden_admin_panel</code>にアクセス．</li>
</ol>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/im07.png"
        alt="This is a image"/>
<img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/im06.png"
        alt="This is a image"/></p>
<ol start="7">
<li>app.min.jsの最下部にあるように，<code>localhost:3000/app.min.js.map</code>へアクセス．</li>
</ol>
<p><img  src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/uoftctf-2025/im05.png"
        alt="This is a image"/></p>
<pre tabindex="0"><code>{
    &#34;version&#34;: 3,
    &#34;file&#34;: &#34;app.js.map&#34;,
    &#34;sources&#34;: [
        &#34;app.js&#34;
    ],
    &#34;names&#34;: [
        &#34;document&#34;,
        &#34;addEventListener&#34;,
        &#34;startButton&#34;,
        &#34;getElementById&#34;,
        &#34;scrollIntoView&#34;,
        &#34;behavior&#34;,
        &#34;style&#34;,
        &#34;display&#34;
    ],
    &#34;mappings&#34;: &#34;AAAAA,SAASC,iBAAiB,mBAAmB,KAAK,MAAMC,YAAYF,SAASG,eAAe,aAAa,EAAE,GAAGD,YAAY,CACtHA,YAAYD,iBAAiB,QAAQ,KACjCD,SAASG,eAAe,MAAM,EAAEC,eAAe,CAACC,SAAS,QAAQ,CAAC,EAClEL,SAASG,eAAe,eAAe,EAAEG,MAAMC,QAAU,OAC7D,CAAC,CACL,CAAC,CAAC&#34;,
    &#34;part7&#34;: &#34;c0d3!!}&#34;
}
</code></pre><p><code>uoftctf{ju57_k33p_c4lm_4nd_1n5p3c7_411_7h3_4pp5_50urc3_c0d3!!}</code></p>
<p>補足：開催後にローカルで実行する手順は，<a href="https://github.com/UofTCTF/uoftctf-2025-chals-public"target="_blank" rel="noopener noreferrer">公式Writeup</a>からソースコードをダウンロードし，
問題のディレクトリ（Dockerfileのある場所）で以下のコマンドを実行する．</p>
<pre tabindex="0"><code>$ docker build -t scavenger-hunt .
$ docker run -p 3000:3000 scavenger-hunt
</code></pre><p><code>http://localhost:3000/</code>にアクセスできる．</p></article><section class="article labels"><a class="category" href="/starknote/categories/security/">Security</a><a class="category" href="/starknote/categories/programming/">Programming</a><a class="tag" href="/starknote/tags/ctf/">CTF</a><a class="tag" href="/starknote/tags/writeup/">writeup</a><a class="tag" href="/starknote/tags/uoft/">uoft</a></section><section class="article author"><img class="avatar" src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/stable-diffusion/immy.png" alt><p class="name">しゅたるく (Stark)</p><div class="details"><a class="item" href="https://github.com/stark2420" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-github"></span>&nbsp;stark2420</a><a class="item" href="https://twitter.com/stark_puyo" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-twitter"></span>&nbsp;@stark_puyo</a></div>
</section>
</div>

<button id="toggle-button" class="nomal-style">
  <h1>目次</h1>
</button>
<div id="toc-container" class="toc-container">
  
      <h2><a href="#top">目次</a></h2>
      <div id="toc" class="toc">
          <nav id="TableOfContents">
  <ul>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#funny-cipher-100">funny-cipher (100)</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#math-test-100">Math Test (100)</a></li>
      </ul>
    </li>
    <li><a href="#web">web</a>
      <ul>
        <li><a href="#scavenger-hunt-100">Scavenger Hunt (100)</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
  
</div>

<script>
  
  document.querySelectorAll('.toc-container a').forEach(link => {
    link.addEventListener('click', function() {
      
      if (window.innerWidth < 1600) {
        
        const tocContainer = document.querySelector('.toc-container');
        if (tocContainer) {
          tocContainer.style.display = 'none';
        }
      }
    });
  });

  
  document.getElementById('toggle-button').addEventListener('click', function() {
    var toc = document.getElementById('toc-container');
    var button = document.getElementById('toggle-button');
    
    
    if (toc.style.display === 'none') {
      toc.style.display = 'block';
      button.innerHTML = '<h1>目次</h1>';  
    } else {
      toc.style.display = 'none';
      button.innerHTML = '<h1>目次</h1>';  
    }
  });

  function highlightActiveTocItem() {
    const tocItems = document.querySelectorAll('.toc a');

    tocItems.forEach(item => {
      const targetId = item.getAttribute('href').substring(1); 
      const targetElement = document.getElementById(targetId);

      if (targetElement) {
        const rect = targetElement.getBoundingClientRect();
        
        
        const isInViewport = rect.top <= 200 && rect.bottom > 0;

        if (isInViewport) {
          
          tocItems.forEach(item => {
            item.classList.remove('active');
          });
          
          item.classList.add('active');
        }
      }
    });
  }

  
  window.addEventListener('scroll', highlightActiveTocItem);
  document.addEventListener('DOMContentLoaded', highlightActiveTocItem);  
</script>

<div class="article bottom"><section class="article navigation"><p><a class="link" href="/starknote/post/new-year-ctf-2025/"><span class="iconfont icon-article"></span>New Year CTF 2025 Writeup</a></p><p><a class="link" href="/starknote/post/irisctf-2025/"><span class="iconfont icon-article"></span>IrisCTF 2025 Writeup</a></p></section><section class="article discussion"><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "starknote" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">©2020 Notepadium.</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a>
<a href='https://ipv6-test.com/validate.php?url=referer'
  ><img src='https://ipv6-test.com/button-ipv6-80x15.png' 
        alt='ipv6 ready' title='ipv6 ready' border='0' 
/></a>
</p></div></section></body>

</html>